<?xml version="1.0"?>
<!DOCTYPE modification SYSTEM "http://www.simplemachines.org/xml/modification">
<modification xmlns="http://www.simplemachines.org/xml/modification" xmlns:smf="http://www.simplemachines.org/">
<id>Dougiefresh:YouTube</id>
<name>Yet Another YouTube BBCode Tag</name>
<version>3.1</version>

<file name="$sourcedir/Post.php">
	<operation error="ignore">
		<search position="replace"><![CDATA['<img>']]></search>
		<add><![CDATA['<img><iframe>']]></add>
	</operation>
	<operation error="ignore">
		<search position="replace"><![CDATA['<img>']]></search>
		<add><![CDATA['<img><iframe>']]></add>
	</operation>
</file>
<file name="$sourcedir/Subs.php">
	<operation>
		<search position="after"><![CDATA[if ($smileys === 'print')]]></search>
		<add><![CDATA[// Added to allow the user the option to not embed a YouTube video
	global $options;
	if (!empty($options['youtube_no_embed']))
	{
		$disabled['youtube'] = true;
		$disabled['yt'] = true;
	}

	]]></add>
	</operation>
	<operation>
		<search position="after"><![CDATA[// Shall we take the time to cache this?
]]></search>
		<add><![CDATA[// Setup for Yet Another YouTube BBCode
	BBCode_YouTube_Fix_Param_Order($message);
		
	]]></add>
	</operation>
	<operation>
		<search position="after"><![CDATA[$orders = permute($preg);]]></search>
		<add><![CDATA[if ($possible['tag'] == 'youtube')
					$orders = array($preg);
				else
					]]></add>
	</operation>
</file>
<file name="$themedir/Profile.template.php">
	<operation>
		<search position="after"><![CDATA[// Choose WYSIWYG settings?]]></search>
		<add><![CDATA[// Added to allow the user the option to not embed a YouTube video
	echo '
							<li>
								<input type="hidden" name="default_options[youtube_no_embed]" value="0" />
								<label for="youtube_no_embed"><input type="checkbox" name="default_options[youtube_no_embed]" id="youtube_no_embed" value="1"', !empty($context['member']['options']['youtube_no_embed']) ? ' checked="checked"' : '', ' class="input_check" /> ', $txt['youtube_no_embed'], '</label>
							</li>';

	]]></add>
	</operation>
</file>
</modification>